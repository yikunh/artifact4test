<!DOCTYPE html><html><head><title>BinCrypto: Binary Cryptographic Function Identification via Similarity Analysis with Path-insensitive Emulation</title><meta charset='utf-8'><link href='https://cdn.maxiang.io/res-min/themes/marxico.css' rel='stylesheet'><style></style></head><body><div id='preview-contents' class='note-content'>
                        
                    

<p></p>



<h3 id="bincrypto-binary-cryptographic-function-identification-via-similarity-analysis-with-path-insensitive-emulation">BinCrypto: Binary Cryptographic Function Identification via Similarity Analysis with Path-insensitive Emulation</h3>

<p>Here is the artifact of BinCrypto. It is provided as a Docker image based on Linux, containing the sample binaries and compiled executables of BinCryptoâ€™s prototype. The file tree of the prototype is:</p>



<pre class="prettyprint hljs-dark"><code class="hljs gherkin"><div class="hljs-line">|<span class="hljs-string">--- binCrypto/</span>
</div><div class="hljs-line"><span class="hljs-string"></span>|<span class="hljs-string">    </span>|<span class="hljs-string">--- bin/                                                  # the directory of binaries</span>
</div><div class="hljs-line"><span class="hljs-string"></span>|<span class="hljs-string">    </span>|<span class="hljs-string">    </span>|<span class="hljs-string">--- x64_libcl347_gcc114_O0</span>
</div><div class="hljs-line"><span class="hljs-string"></span>|<span class="hljs-string">    </span>|<span class="hljs-string">    </span>|<span class="hljs-string">--- x64_libcl347_gcc114_O3</span>
</div><div class="hljs-line"><span class="hljs-string"></span>|<span class="hljs-string">    </span>|<span class="hljs-string">    </span>|<span class="hljs-string">--- ...</span>
</div><div class="hljs-line"><span class="hljs-string"></span>|<span class="hljs-string">    </span>|<span class="hljs-string">--- data/                                                 # the directory of binaries' preprocess data</span>
</div><div class="hljs-line"><span class="hljs-string"></span>|<span class="hljs-string">    </span>|<span class="hljs-string">    </span>|<span class="hljs-string">--- x64_libcl347_gcc114_O0/</span>
</div><div class="hljs-line"><span class="hljs-string"></span>|<span class="hljs-string">    </span>|<span class="hljs-string">    </span>|<span class="hljs-string">--- x64_libcl347_gcc114_O3/</span>
</div><div class="hljs-line"><span class="hljs-string"></span>|<span class="hljs-string">    </span>|<span class="hljs-string">    </span>|<span class="hljs-string">--- ...</span>
</div><div class="hljs-line"><span class="hljs-string"></span>|<span class="hljs-string">    </span>|<span class="hljs-string">--- scripts/                                              # the directory of Python scripts</span>
</div><div class="hljs-line"><span class="hljs-string"></span>|<span class="hljs-string">    </span>|<span class="hljs-string">--- signatures/                                           # the directory of extracted code features</span>
</div><div class="hljs-line"><span class="hljs-string"></span>|<span class="hljs-string">    </span>|<span class="hljs-string">    </span>|<span class="hljs-string">--- x64_libcl347_gcc114_O0/</span>
</div><div class="hljs-line"><span class="hljs-string"></span>|<span class="hljs-string">    </span>|<span class="hljs-string">    </span>|<span class="hljs-string">--- x64_libcl347_gcc114_O3/</span>
</div><div class="hljs-line"><span class="hljs-string"></span>|<span class="hljs-string">    </span>|<span class="hljs-string">    </span>|<span class="hljs-string">--- ...</span>
</div><div class="hljs-line"><span class="hljs-string"></span>|<span class="hljs-string">    </span>|<span class="hljs-string">--- output/                                               # the directory of similarity scores</span>
</div><div class="hljs-line"><span class="hljs-string"></span>|<span class="hljs-string">    </span>|<span class="hljs-string">    </span>|<span class="hljs-string">--- x64_libcl347_gcc114_O3VSx64_libcl347_gcc114_O0/</span>
</div><div class="hljs-line"><span class="hljs-string"></span>|<span class="hljs-string">    </span>|<span class="hljs-string">--- comparison                                            # the executable to compare two binaries for similarity scores</span>
</div><div class="hljs-line"><span class="hljs-string"></span>|<span class="hljs-string">    </span>|<span class="hljs-string">--- emulation                                             # the executable to emulate one binary for code features</span>
</div><div class="hljs-line"><span class="hljs-string"></span>|<span class="hljs-string">    </span>|<span class="hljs-string">--- random.txt                                            # the random input values for emulation</span>
</div><div class="hljs-line"><span class="hljs-string"></span>|<span class="hljs-string">    </span>|<span class="hljs-string">--- Dockerfile                                            # the configuration file for Docker</span>
</div></code></pre>

<h4 id="0-start-with-the-docker-image">0. Start with the Docker Image</h4>



<pre class="prettyprint hljs-dark"><code class="language-bash hljs"><div class="hljs-line">docker pull tracyjames/bincrypto:latest
</div><div class="hljs-line">docker run --name bincrypto -it tracyjames/bincrypto:latest
</div></code></pre>

<ul><li><p>Then, it is under the root path of the prototype.</p></li>
</ul>

<h4 id="1-emulate-the-sample-binaries-of-x64libcl347gcc114o3-and-x64libcl347gcc114o0">1. Emulate the Sample Binaries of x64_libcl347_gcc114_O3 and x64_libcl347_gcc114_O0</h4>



<pre class="prettyprint hljs-dark"><code class="language-bash hljs"><div class="hljs-line"><span class="hljs-comment"># emulate to extract function signatures</span>
</div><div class="hljs-line">python3 script/emulate_binary.py x64_libcl347_gcc114_O3
</div><div class="hljs-line">python3 script/emulate_inary.py x64_libcl347_gcc114_O0
</div></code></pre>

<ul><li><p><strong>x64_libcl347_gcc114_O3/O0</strong> is cryptolib v3.4.7 which is compiled with GCC v11.4.0 -O3/-O0 for x64.</p></li>
<li><p>The signature sequence of each function is recorded in the file under the path <strong>(root)/signatures/x64_libcl347_gcc114_O3/</strong> and <strong>(root)/signatures/x64_libcl347_gcc114_O0/</strong>.</p></li>
</ul>

<h4 id="2-compare-the-sample-binaries">2. Compare the Sample Binaries</h4>



<pre class="prettyprint hljs-dark"><code class="language-bash hljs"><div class="hljs-line"><span class="hljs-comment"># REF: x64_libcl347_gcc114_O0</span>
</div><div class="hljs-line"><span class="hljs-comment"># TAR: x64_libcl347_gcc114_O3</span>
</div><div class="hljs-line"><span class="hljs-comment"># compare each function signature of the TAR to those of the REF</span>
</div><div class="hljs-line">python3 script/compare_binaries.py x64_libcl347_gcc114_O3 x64_libcl347_gcc114_O0
</div></code></pre>

<ul><li><p>The results of similarity scores are under the path <strong>(root)/output/x64_libcl347_gcc114_O3VSx64_libcl347_gcc114_O0/</strong></p>

<ul>
<li><p>Each file is named as that of a TAR function.</p></li>
<li><p>Each line of a file is SRC function and the similarity score with the TAR function.</p></li></ul></li>
</ul></div></body></html>